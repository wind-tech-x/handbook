---
sidebar_position: 3
---
# レビューを進める際のステップ
## まとめ
複数ファイルに分散しているコード変更(CL: Change List)を、もっとも効率的に管理するにはどうすればよいでしょうか？

* 変更内容は妥当か？ 説明は適切か？
* 最も重要な部分をまず確認して、全体的に適切な設計かどうかを判断する。
* CLの残りの部分は、適切な順序で確認する。

## ステップ 1: 変更全体を大まかに把握する
まずは CL の説明と、その CL が全体として何を行っているかを確認します。この変更はそもそも妥当でしょうか？ もし「この変更自体がそもそも不要」という場合は、できるだけ早くその理由を伝え、どのようにすべきだったのかを提案してあげてください。

たとえば、次のようにコメントするかもしれません。

「これは良い取り組みですね、ありがとうございます。ただし、実は私たちは現在、ここで修正されている FooWidget システムを廃止する方向に進んでいるので、今は新たな変更を加えたくありません。代わりに BarWidget クラスをリファクタリングしてみてはどうでしょうか？」

この例では、レビュアーは現在の CL を却下しつつも、代替案を提案しています。また、その提案を礼儀正しい形で行っています。意見が合わない時も、相手に敬意を払うことが大切です。

もし「そもそも望まれていない変更」を表す CL が何度も送られてくるようであれば、チームの開発プロセスや、外部コントリビューターが投稿する際のプロセスを見直しましょう。CL を書く前の段階でコミュニケーションを取り、不要な作業を事前に防ぐほうが、お互いに無駄を省けます。

## ステップ 2: CL の主要部分を確認する
CL の「メイン」となるファイル（またはファイル群）を探します。たいていの場合、論理的に大きな変更がまとめて書かれているファイルがあり、それが CL の主要部分です。まずこの主要部分を確認することで、その他の小さな変更を見る際のコンテキストを得やすくなり、全体のレビューがスムーズになります。もし CL が大きすぎて主要部分を見つけられない場合は、開発者に「どこから見ればよいか」を訊ねたり、CL を分割してもらうよう提案するのもよいでしょう。

主要部分を確認して大きな設計上の問題が見つかった場合、他の部分をレビューする前でも、すぐにその問題点を指摘しましょう。なぜなら、もし設計上の問題が重大であれば、その後にレビューするはずだった大部分のコードが大幅に変更されたり、消えてしまうことが多いからです。

この「大きな設計上の問題を見つけたら即時に知らせる」ことが重要な理由は 2 つあります。

開発者は CL を送ったあと、レビューの合間にもその CL をベースに新たな作業を進めている場合が多いです。レビュー中の CL に重大な設計の問題があるなら、後続の CL もまとめて手直しが必要になってしまいます。問題のある設計の上に作業を進めないよう、なるべく早く気づかせる必要があります。
大きな設計変更には時間がかかります。開発者には締切があることがほとんどです。コードの品質を保ちつつ締切を守るためには、重大な修正が必要だと分かったら、開発者にすぐに作業に取りかかってもらう必要があります。

## ステップ 3: 残りの部分を適切な順序で確認する
CL 全体の設計に大きな問題がないと確認したら、今度はファイルを論理的な順序で見ていきましょう。ただし、どのファイルもレビュー漏れがないようにします。多くの場合、主要ファイルを確認した後は、レビュー用ツールが提示する順番に沿ってファイルを確認するのが最もシンプルです。

時には、メインコードを読む前にテストを先に読むと、変更が意図する内容がイメージしやすくなることもあります。テストを読むことで「この変更は何をしようとしているのか」を把握し、本体コードの理解がスムーズになる場合があります。