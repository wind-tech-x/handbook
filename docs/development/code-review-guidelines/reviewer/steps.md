---
sidebar_position: 3
---
# レビューを進める際のステップ
## まとめ
複数ファイルに分散しているコード変更(CL: Change List)を、もっとも効率的に管理するにはどうすればよいか？

* 変更内容は妥当か？ 説明は適切か？
* 最も重要な部分をまず確認して、全体的に適切な設計かどうかを判断する。
* CLの残りの部分は、適切な順序で確認する。

## ステップ 1: 変更全体を大まかに把握する
まずはCLの説明と、そのCLが全体として何を行っているかを確認する。
この変更はそもそも妥当だろうか？ 
もし「この変更自体がそもそも不要」という場合は、できるだけ早くその理由を伝え、どのようにすべきだったのかを提案してあげる。

たとえば、次のようにコメントする。

>「良い取り組みですね、ありがとうございます。ただ、実は現在、ここで修正されているFooWidgetシステムを廃止する方向で進んでいるため、新たな変更を加えたくありません。代わりにBarWidgetクラスをリファクタリングしてみてはどうでしょうか？」

この例では、レビュアーは現在のCLを却下しつつも、礼儀正しい形で代替案を提案している。
意見が合わない時も、相手に敬意を払うことが大切である。

もし「そもそも望まれていない変更」を表すCLが何度も送られてくるようであれば、チームの開発プロセスや、外部コントリビューターが投稿する際のプロセスを見直す必要がある。
CLを書く前の段階でコミュニケーションを取り、不要な作業を行わない方が、お互いにとってよい結果となる。

## ステップ 2: CLの主要部分を確認する
CLの「メイン」となるファイル（またはファイル群）を探す。
たいていの場合、論理的に大きな変更がまとめて書かれているファイルがあり、それがCLの主要部分となる。
まずこの主要部分を確認することで、その他の小さな変更を見る際のコンテキストを得やすくなり、全体のレビューがスムーズになる。
もしCLが大きすぎて主要部分を見つけられない場合は、開発者に「どこから見ればよいか」を訊ねたり、CLを分割してもらうよう提案してもよい。

他の部分をレビューする前でも、主要部分を確認して**大きな設計上の問題が見つかった場合、すぐにその問題点を指摘すること**。
なぜなら、もし設計上の問題が重大であれば、その後にレビューするはずだった大部分のコードが大幅に変更されたり、消えてしまうことが多いからである。

この「大きな設計上の問題を見つけたら即時に知らせる」ことが重要な理由は 2 つある。

* 開発者はCLを送ったあと、レビューの合間にもそのCLをベースに新たな作業を進めている場合が多い。

レビュー中のCLに重大な設計の問題があるなら、後続のCLもまとめて手直しが必要になる。
問題のある設計の上に作業を進めないよう、なるべく早く開発者に気づかせる必要がある。

* 大きな設計変更には時間がかかり、開発者には締切があることがほとんどである。

コードの品質を保ちつつ締切を守るためには、重大な修正が必要だと分かったら、開発者にすぐに作業に取りかかってもらう必要がある。

## ステップ 3: 残りの部分を適切な順序で確認する
CL全体の設計に大きな問題がないと確認したら、今度はファイルを論理的な順序で見ていく。
ただし、どのファイルもレビュー漏れがないようにする。
多くの場合、主要ファイルを確認した後は、レビュー用ツールが提示する順番に沿ってファイルを確認するのが単純な方法である。

時には、メインコードを読む前にテストを先に読むと、変更が意図する内容がイメージしやすくなることもある。
テストを読むことで「この変更は何をしようとしているのか」を把握し、本体コードの理解がスムーズになる場合がある。